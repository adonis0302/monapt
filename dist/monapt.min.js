!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.monapt=b()}(this,function(){var a;!function(a){a.Tuple1=function(a){return{_1:a}},a.Tuple2=function(a,b){return{_1:a,_2:b}}}(a||(a={}));var a,b=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)};!function(a){var c=function(a){function c(){a.call(this,"No such element."),this.name="NoSuchElementError",this.message="No such element.",this.stack=(new Error).stack}return b(c,a),c}(Error);a.NoSuchElementError=c,a.Option=function(b){return"undefined"!=typeof b&&null!==b?new d(b):a.None};var d=function(){function b(a){this.value=a,this.isDefined=!0,this.isEmpty=!1}return b.prototype.get=function(){return this.value},b.prototype.getOrElse=function(){return this.value},b.prototype.orElse=function(){return this},b.prototype.match=function(a){return a.Some(this.value)},b.prototype.map=function(a){return new b(a(this.get()))},b.prototype.flatMap=function(a){return a(this.get())},b.prototype.filter=function(b){return b(this.value)?this:a.None},b.prototype.reject=function(a){return this.filter(function(b){return!a(b)})},b.prototype.foreach=function(a){a(this.value)},b}();a.Some=d;var e=function(){function b(){this.isDefined=!1,this.isEmpty=!0}return b.prototype.get=function(){throw new c},b.prototype.getOrElse=function(a){return a()},b.prototype.orElse=function(a){return a()},b.prototype.match=function(a){return a.None()},b.prototype.map=function(){return a.None},b.prototype.flatMap=function(){return a.None},b.prototype.filter=function(){return this},b.prototype.reject=function(){return this},b.prototype.foreach=function(){},b}();a.None=new e,a.flatten=function(a){for(var b=[],c=0,d=a.length;d>c;c++)a[c].isDefined&&b.push(a[c].get());return b}}(a||(a={}));var a;!function(a){var b=function(a){return a},c=function(){function b(a){this.value=a,this.isSuccess=!0,this.isFailure=!1}return b.prototype.get=function(){return this.value},b.prototype.getOrElse=function(){return this.get()},b.prototype.orElse=function(){return this},b.prototype.match=function(a){return a.Success(this.get())},b.prototype.map=function(b){var c=this;return a.Try(function(){return b(c.value)})},b.prototype.flatMap=function(a){try{return a(this.value)}catch(b){return new d(b)}},b.prototype.filter=function(a){try{return a(this.value)?this:new d(new Error("Predicate does not hold for "+this.value))}catch(b){return new d(b)}},b.prototype.reject=function(a){return this.filter(function(b){return!a(b)})},b.prototype.foreach=function(a){a(this.value)},b.prototype.recover=function(){return this},b.prototype.recoverWith=function(){return this},b.prototype.toOption=function(){return new a.Some(this.value)},b}();a.Success=c;var d=function(){function d(a){this.exception=a,this.isSuccess=!1,this.isFailure=!0}return d.prototype.get=function(){throw this.exception},d.prototype.getOrElse=function(a){return a()},d.prototype.orElse=function(a){return a()},d.prototype.match=function(a){return a.Failure(this.exception)},d.prototype.map=function(){return b(this)},d.prototype.flatMap=function(){return b(this)},d.prototype.filter=function(){return this},d.prototype.reject=function(){return this},d.prototype.foreach=function(){},d.prototype.recover=function(a){try{return new c(a(this.exception))}catch(b){return new d(b)}},d.prototype.recoverWith=function(a){try{return a(this.exception)}catch(b){return new d(this.exception)}},d.prototype.toOption=function(){return a.None},d}();a.Failure=d,a.Try=function(a){try{return new c(a())}catch(b){return new d(b)}}}(a||(a={}));var a;!function(a){var b=function(){function a(){this.fired=!1,this.callbacks=new Array}return a.prototype.fire=function(a){if(this.producer=a,this.fired)throw new Error("Dose fired twice, Can call only once.");this.fireAll()},a.prototype.fireAll=function(){var a=this;this.fired=!0,this.callbacks.forEach(function(b){return a.producer(b)})},a.prototype.add=function(a){this.fired?this.producer(a):this.callbacks.push(a)},a}();a.Cracker=b}(a||(a={}));var a;!function(a){function c(a){var b=function(b){b instanceof Error?a.failure(b):a.success(b)};return b.success=function(b){return a.success(b)},b.failure=function(b){return a.failure(b)},b}var d=function(){function b(b){this.cracker=new a.Cracker,b(c(this))}return b.succeed=function(a){return new b(function(b){return b.success(a)})},b.failed=function(a){return new b(function(b){return b.failure(a)})},b.prototype.success=function(b){this.cracker.fire(function(c){return c(new a.Success(b))})},b.prototype.failure=function(b){this.cracker.fire(function(c){return c(new a.Failure(b))})},b.prototype.onComplete=function(a){this.cracker.add(a)},b.prototype.onSuccess=function(a){this.onComplete(function(b){b.match({Success:function(b){return a(b)},Failure:function(){}})})},b.prototype.onFailure=function(a){this.onComplete(function(b){b.match({Success:function(){},Failure:function(b){return a(b)}})})},b.prototype.map=function(a){var b=new e;return this.onComplete(function(d){d.match({Failure:function(a){return b.failure(a)},Success:function(d){return a(d,c(b))}})}),b.future()},b.prototype.flatMap=function(a){var b=new e;return this.onComplete(function(c){c.match({Failure:function(a){return b.failure(a)},Success:function(c){a(c).onComplete(function(a){a.match({Success:function(a){return b.success(a)},Failure:function(a){return b.failure(a)}})})}})}),b.future()},b.prototype.filter=function(b){var c=new e;return this.onComplete(function(d){d.match({Failure:function(a){c.failure(a)},Success:function(d){try{b(d)?c.success(d):c.failure(new a.NoSuchElementError)}catch(e){c.failure(e)}}})}),c.future()},b.prototype.reject=function(a){return this.filter(function(b){return!a(b)})},b.prototype.recover=function(a){var b=new e;return this.onComplete(function(d){d.match({Failure:function(d){try{a(d,c(b))}catch(e){b.failure(e)}},Success:function(a){return b.success(a)}})}),b.future()},b.prototype.recoverWith=function(a){var b=new e;return this.onComplete(function(c){return c.match({Failure:function(c){a(c).onComplete(function(a){return a.match({Success:function(a){return b.success(a)},Failure:function(a){return b.failure(a)}})})},Success:function(a){return b.success(a)}})}),b.future()},b}();a.Future=d;var e=function(a){function c(){a.call(this,function(){}),this.isComplete=!1}return b(c,a),c.prototype.success=function(b){this.isComplete=!0,a.prototype.success.call(this,b)},c.prototype.failure=function(b){this.isComplete=!0,a.prototype.failure.call(this,b)},c.prototype.future=function(){return this},c}(d);a.Promise=e,a.future=function(a){var b=new e;try{a(c(b))}catch(d){b.failure(d)}return b.future()}}(a||(a={}));var a;return function(a){var b;!function(b){var c=function(){function b(){this.table={}}return b.prototype.register=function(a,b){this.table[a]=b},b.prototype.index=function(b){return this.table[b]?new a.Some(this.table[b]):a.None},b}();b.StringSelector=c;var d=function(){function b(){this.table={}}return b.prototype.register=function(a,b){this.table[a.hash()]=b},b.prototype.index=function(b){var c=b.hash();return this.table[c]?new a.Some(this.table[c]):a.None},b}();b.HashableSelector=d;var e=function(){function b(){}return b.prototype.register=function(){},b.prototype.index=function(){return a.None},b}();b.ObjectSelector=e}(b||(b={}));var c=function(){function c(a,b){for(var c=[],d=2;d<arguments.length;d++)c[d-2]=arguments[d];if(this.real=[],b){if(0!=c.length&&c.length%2!=0)throw new Error(c[c.length-1]+" has not value.");this.ensureSelector(a),this.add(a,b);for(var e=0,f=c.length;f>e;e+=2)this.add(c[e],c[e+1])}else if(a){var g=a;for(var h in g)this.ensureSelector(h),this.add(h,g[h])}this.ensureSelector()}return c.prototype.ensureSelector=function(a){void 0===a&&(a=null),this.selector||(this.selector=a?"string"==typeof a?new b.StringSelector:a.hash?new b.HashableSelector:new b.ObjectSelector:new b.ObjectSelector)},c.prototype.add=function(b,c){this.real.push(a.Tuple2(b,c)),this.selector.register(b,this.real.length-1)},c.prototype.foreach=function(a){this.real.forEach(function(b){return a(b._1,b._2)})},c.prototype.map=function(a){var b=new c;return this.foreach(function(c,d){var e=a(c,d);b.add(e._1,e._2)}),b},c.prototype.flatMap=function(a){var b=new c;return this.foreach(function(c,d){var e=a(c,d);e.foreach(function(a,c){return b.add(a,c)})}),b},c.prototype.mapValues=function(a){var b=new c;return this.foreach(function(c,d){b.add(c,a(d))}),b},c.prototype.filter=function(a){var b=new c;return this.foreach(function(c,d){a(c,d)&&b.add(c,d)}),b},c.prototype.reject=function(a){return this.filter(function(b,c){return!a(b,c)})},c.prototype.find=function(a){return this.filter(a).head()},c.prototype.get=function(b){var c=this;return this.selector.index(b).map(function(a){return c.real[a]._2}).orElse(function(){return c.find(function(a){return a==b}).map(function(a){return a._2}).orElse(function(){return a.None})})},c.prototype.getOrElse=function(a,b){return this.get(a).getOrElse(b)},c.prototype.head=function(){return this.real.length>0?new a.Some(this.real[0]):a.None},c}();a.Map=c}(a||(a={})),a});